"use strict";function ready(e,t){e?console.log(e):console.log(t);var a=t.filter(function(e){return"US-TOTAL"==e.state}),n=d3.nest().key(function(e){return e.source}).entries(a);console.log(n),xScale.domain(d3.extent(a,function(e){return e.date})),yScale.domain(d3.extent(a,function(e){return e.mwh})).nice();var r=d3.axisBottom().scale(xScale).tickFormat(formatMonth),i=d3.axisLeft().scale(yScale),l=d3.select("#line-div").append("svg").attr("width",lineW+lineMargin.left+lineMargin.right).attr("height",lineH+lineMargin.top+lineMargin.bottom).attr("id","line-canvas").append("g").attr("transform","translate("+lineMargin.left+","+lineMargin.top+")"),s=d3.line().curve(d3.curveLinear).x(function(e){return xScale(e.date)}).y(function(e){return yScale(+e.mwh)});l.selectAll(".line").data(n).enter().append("path").attr("class","line").attr("class",function(e){return"line-"+e.key}).attr("d",function(e){return s(e.values)}).attr("fill","none").attr("stroke","white"),l.append("g").attr("class","axis x-axis").attr("transform","translate(0,"+lineH+")").call(r),d3.selectAll(".x-axis text").attr("transform","translate(-20,20) rotate(-45)"),l.append("g").attr("class","axis y-axis").call(i)}var margin={top:20,right:20,bottom:20,left:20},w=(w=parseInt(d3.select("#wrapper").style("width"),10))-margin.left-margin.right,h=(h=parseInt(d3.select("#wrapper").style("height")))-margin.top-margin.bottom,lineMargin={top:20,right:20,bottom:60,left:100},lineW=(lineW=parseInt(d3.select("#line-div").style("width"),10))-lineMargin.left-lineMargin.right,lineH=(lineH=parseInt(d3.select("#line-div").style("height"),10))-lineMargin.top-lineMargin.bottom,parseDate=d3.timeParse("%m-%Y"),parseYear=d3.timeParse("%Y"),formatMonth=d3.timeFormat("%Y"),xScale=d3.scaleTime().range([0,lineW]),yScale=d3.scaleLinear().range([lineH,0]),dotRadius="0.25em";d3.queue().defer(d3.csv,"/8step.io/production_data/energy_data/energy_xstate.csv",function(e){return e.date=parseDate(e.date),e.mwh=+e.mwh,e.id=e.id,e}).await(ready);