"use strict";function ready(t,e){t?console.log(t):console.log(e);var a=e.filter(function(t){return"US-TOTAL"==t.state}),n=d3.nest().key(function(t){return t.source}).entries(a);console.log(n),xScale.domain(d3.extent(a,function(t){return t.date})),yScale.domain(d3.extent(a,function(t){return t.mwh})).nice();var r=d3.axisBottom().scale(xScale).tickFormat(formatMonth),i=d3.axisLeft().scale(yScale),l=d3.select("#line-div").append("svg").attr("width",lineW+lineMargin.left+lineMargin.right).attr("height",lineH+lineMargin.top+lineMargin.bottom).attr("id","line-canvas").append("g").attr("transform","translate("+lineMargin.left+","+lineMargin.top+")"),s=d3.line().curve(d3.curveLinear).x(function(t){return xScale(t.date)}).y(function(t){return yScale(+t.mwh)});l.selectAll(".line").data(n).enter().append("path").attr("class","line").attr("class",function(t){return"line-"+t.key}).attr("d",function(t){return s(t.values)}).attr("fill","none").attr("stroke","white"),l.append("g").attr("class","axis x-axis").attr("transform","translate(0,"+lineH+")").call(r),d3.selectAll(".x-axis text").attr("transform","translate(-20,20) rotate(-45)"),l.append("g").attr("class","axis y-axis").call(i);var o={top:20,right:20,bottom:20,left:20},d=(d=parseInt(d3.select("#donut-div").style("width"),10))+o.left+o.right,c=(c=parseInt(d3.select("#donut-div").style("width"),10))+o.top+o.bottom;d3.select("#donut-div").append("svg").attr("width",d+o.left+o.right).attr("height",c+o.top+o.bottom).attr("id","donut-canvas").append("g").attr("transform","translate("+(d/2+o.left)+","+(c/2+o.top)+")")}var margin={top:20,right:20,bottom:20,left:20},w=(w=parseInt(d3.select("#wrapper").style("width"),10))-margin.left-margin.right,h=(h=parseInt(d3.select("#wrapper").style("height")))-margin.top-margin.bottom,lineMargin={top:20,right:20,bottom:60,left:100},lineW=(lineW=parseInt(d3.select("#line-div").style("width"),10))-lineMargin.left-lineMargin.right,lineH=(lineH=parseInt(d3.select("#line-div").style("height"),10))-lineMargin.top-lineMargin.bottom,parseDate=d3.timeParse("%m-%Y"),parseYear=d3.timeParse("%Y"),formatMonth=d3.timeFormat("%Y"),xScale=d3.scaleTime().range([0,lineW]),yScale=d3.scaleLinear().range([lineH,0]),dotRadius="0.25em";d3.queue().defer(d3.csv,"/nickm.io/production_data/energy_data/energy_xstate.csv",function(t){return t.date=parseDate(t.date),t.mwh=+t.mwh,t.id=t.id,t}).await(ready);