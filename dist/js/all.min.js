d3.csv("datadev/crime.csv",function(t,e){t?console.log(t):console.log(e);var a=e,r={top:40,right:40,bottom:60,left:60},i=740-r.left-r.right,n=740-r.left-r.right,l=30,o=-30,s=function(t){return t.key},d=d3.select("body").append("svg").attr({height:n+r.top+r.bottom,width:i+r.left+r.right}).append("g").attr({transform:"translate("+r.left+","+r.top+")"}),c=(d.append("clipPath").attr({id:"chart-area"}).append("rect").attr({x:1-l,y:1-o,width:i,height:n}),d3.scale.linear().domain([0,d3.max(a,function(t){return+t.rape100k})]).range([0,i])),u=d3.scale.linear().domain([0,d3.max(a,function(t){return+t.murder100k})]).range([n,0]),p=d3.scale.linear().domain([d3.min(a,function(t){return+t.Pop}),d3.max(a,function(t){return+t.Pop})]).range([5,50]),f=d3.svg.axis().scale(c).orient("bottom").ticks(5),g=d3.svg.axis().scale(u).orient("left").ticks(5);d.append("g").attr({id:"bubbles-group","clip-path":"url(#chart-area)"}).selectAll("circle").data(a,s).enter().append("circle").attr({cx:function(t){return c(+t.rape100k)},cy:function(t){return u(+t.murder100k)},r:function(t){return p(+t.Pop)},class:"bubbles",fill:"rgb(179,120,211)"});d.append("g").attr({class:"xaxis",transform:"translate(0,"+(n+l)+")"}).call(f),d.append("g").attr({class:"yaxis",transform:"translate("+o+",0)"}).call(g)});var margin={top:10,right:20,bottom:20,left:80},w=parseInt(d3.select("#line-div").style("width"),10),w=w-margin.left-margin.right,h=parseInt(d3.select("#line-div").style("height"),10),h=h-margin.top-margin.bottom,parseDate=d3.timeParse("%Y"),formatTime=d3.timeFormat("%Y"),xScale=d3.scaleTime().range([0,w]),yScale=d3.scaleLinear().range([h,0]),yLabelShift=margin.left/2-10,tipDuration=100;d3.csv("/8step.io/production_data/energy_data/solar.csv",function(t){return t.year=parseDate(t.year),t.solar_price=+t.solar_price,t},function(t,e){t?console.log(t):console.log(e);var a=e;xScale.domain(d3.extent(a,function(t){return t.year})),yScale.domain(d3.extent(a,function(t){return t.solar_price})).nice();var r=d3.axisBottom().scale(xScale),i=d3.axisLeft().scale(yScale),n=d3.line().x(function(t){return xScale(t.year)}).y(function(t){return yScale(t.solar_price)}),l=d3.select("#line-div").append("svg").attr("width",w+margin.left+margin.right).attr("height",h+margin.top+margin.bottom).attr("id","canvas").append("g").attr("transform","translate("+margin.left+","+margin.top+")"),o=d3.select("body").append("div").attr("class","tooltip price-tip").style("opacity",0),s=(l.append("path").datum(a).attr("d",n).attr("class","line"),l.selectAll("circle").data(a).enter().append("circle").attr("class","nodes price-nodes").attr("r","0.15em").attr("cx",function(t){return xScale(t.year)}).attr("cy",function(t){return yScale(t.solar_price)}));s.on("mouseover",function(t){o.transition().duration(tipDuration).style("opacity",.8),o.html("<span class = date-display>"+formatTime(t.year)+"</span><br/><span class='value-display'>$"+d3.format(".3n")(t.solar_price)+"</span>").style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY-40+"px")}).on("mouseout",function(t){o.transition().duration(tipDuration).style("opacity",0)}),l.append("g").attr("class","axis x-axis").attr("transform","translate(0,"+h+")").call(r),l.append("g").attr("class","axis y-axis").call(i).append("text").text("Price, US$/Watt").attr("fill","gray").attr("transform","translate("+yLabelShift+","+(h/2-margin.bottom-margin.top)+"), rotate(-90)")});var margin={top:80,right:140,bottom:40,left:60},w=parseInt(d3.select("#scatter-div").style("width"),10),w=w-margin.left-margin.right,h=parseInt(d3.select("#scatter-div").style("height"),10),h=h-margin.top-margin.bottom,canvasPadding={top:10,right:10,bottom:10,left:60},textShift=0,dotsShiftX=0,dotsShiftY=0,xaxisShiftX=60,yaxisShiftX=60,xaxisShiftY=-60,yaxisShiftY=0,infoTop=115,infoLeft=w+margin.left,infoWidth="12em",infoHeight="24em";d3.csv("/8step.io/production_data/world_data/datadev/world.csv",function(error,data){error?console.log(error):console.log(data);var worldData=data,key=function(t,e){return t.country},dataX=function(t){return+t.polistab},dataY=function(t){return 100-+t.press},dataR=function(t){return+t.gdphead};console.log(dataX.toString());var titleX="Political Stabtility",titleY="Press Freedom",titleR="GDP per Capita",titleText=d3.select("h2#chart-title").append("text.title-text").text(titleX+" vs. "+titleY),dotTips=d3.tip().attr("class","d3-tip").style({top:infoTop,left:infoLeft,width:infoWidth,height:infoHeight}).direction("e").html(function(t){return"<p id='tiphead'>"+t.country+"</p><p class='tip-subhead'>Income Group:</p><p class='tip-body'>"+t.ig+"</p><p class='tip-subhead'>Region:</p><p class='tip-body'>"+t.region+"</p>"}),svg=d3.select("#scatter-div").append("svg").attr({width:w+margin.left+margin.right,height:h+margin.top+margin.bottom,id:"canvas"}).append("g").attr({transform:"translate("+margin.left+","+margin.top+")"}),xScale=d3.scale.linear().domain([d3.min(worldData,function(t){return dataX(t)}),d3.max(worldData,function(t){return dataX(t)})]).range([xaxisShiftX,w]).nice(),yScale=d3.scale.linear().domain([d3.max(worldData,function(t){return dataY(t)}),d3.min(worldData,function(t){return dataY(t)})]).range([0,h+xaxisShiftY]).nice(),rScale=d3.scale.linear().domain([0,d3.max(worldData,function(t){return dataR(t)})]).range([4,40]).nice(),xAxis=d3.svg.axis().scale(xScale).orient("bottom"),yAxis=d3.svg.axis().scale(yScale).orient("left"),guideLines=function(t){svg.append("g").classed("guide",!0).append("line").attr("y1",d3.select(".a-dot").attr("cy")).attr("y2",d3.select(".a-dot").attr("cy")).attr("x1",yaxisShiftX).attr("x2",d3.select(".a-dot").attr("cx")).attr("stroke",d3.select(".a-dot").attr("fill")),svg.append("g").classed("guide",!0).append("line").attr("y1",h+xaxisShiftY).attr("y2",d3.select(".a-dot").attr("cy")).attr("x1",d3.select(".a-dot").attr("cx")).attr("x2",d3.select(".a-dot").attr("cx")).attr("stroke",d3.select(".a-dot").attr("fill"))},mouseOn=function(){d3.select(this).attr("opacity",1).classed("a-dot",!0).classed("dots",!1),guideLines(),d3.selectAll("circle.dots").attr("opacity",.15)},mouseOff=function(){d3.select(this).classed("a-dot",!1).classed("dots",!0),d3.selectAll(".guide").remove(),d3.selectAll("circle.dots").attr("opacity",.85)},dotsGroup=svg.append("g").attr({id:"dots-group"}),dotsFilter=dotsGroup.append("defs").append("filter").attr({id:"dots-filter",x:0,y:0,width:"200%",height:"200%"}),shadowOffset=dotsFilter.append("feOffset").attr({result:"offOut",in:"SourceGraphic",dx:20,dy:20}),shadowBlend=dotsFilter.append("feBlend").attr({in:"SourceGraphic",in2:"offOut",mode:"normal"}),dots=d3.select("#dots-group").selectAll("circle").data(worldData,key).enter().append("circle").filter(function(t){return dataX(t)}).filter(function(t){return dataY(t)}).filter(function(t){return dataR(t)}).attr({class:"dots",id:function(t){return t.country},cx:function(t){return xScale(dataX(t))},cy:function(t){return yScale(dataY(t))},r:function(t){return rScale(dataR(t))},"pointer-events":"all",fill:function(t){return"High income: nonOECD"==t.ig?"#FF6E27":"Low income"==t.ig?"#991766":"Upper middle income"==t.ig?"#F34739":"Lower middle income"==t.ig?"#D90F5A":"High income: OECD"==t.ig?"#FFB627":"black"},opacity:.85}).style({}).call(dotTips).on("mouseenter",dotTips.show).on("mouseover",mouseOn).on("mouseleave",dotTips.hide).on("mouseout",mouseOff);svg.append("g").attr({class:"xaxis",transform:"translate(0,"+(h+xaxisShiftY)+")"}).call(xAxis);var xLabel=svg.append("text").attr({class:"x-label","text-anchor":"middle",transform:function(t){return"translate("+w/2+","+h+")"}}).text(titleX);svg.append("g").attr({class:"yaxis",transform:"translate("+yaxisShiftX+",0)"}).call(yAxis);var yLabel=svg.append("text").attr({class:"y-label","text-anchor":"middle",transform:function(t){return"translate(0,"+(h+xaxisShiftY)/2+") rotate(-90)"}}).text(titleY);d3.selectAll(".x-choice").on("click",function(){var xValue=d3.select(this).attr("value");console.log(xValue);var dataX=function(d){return eval(xValue)};switch(xValue){case"+d.gini":titleX="Gini Index";break;case"+d.press":titleX="Press Freedom";break;case"+d.mfr":titleX="Male to female Ratio";break;case"+d.life_exp":titleX="Life Expectancy";break;case"+d.gre":titleX="Female enrollment ratio";break;case"+d.corruption":titleX="Control of Corruption";break;case"+d.polistab":titleX="Political Stability";break;case"+d.gdphead":titleX="GDP per Capita"}var xScale=d3.scale.linear().domain([d3.min(worldData,function(t){return dataX(t)}),d3.max(worldData,function(t){return dataX(t)})]).range([xaxisShiftX,w]).nice();d3.select("#dots-group").selectAll("circle").filter(function(t){return dataX(t)}).transition().duration(1e3).attr({cx:function(t){return xScale(dataX(t))}});var xAxis=d3.svg.axis().scale(xScale).orient("bottom");xLabel.text(titleX),titleText.text(titleX+" vs. "+titleY),d3.select(".xaxis").transition().duration(1e3).call(xAxis)}),d3.selectAll(".y-choice").on("click",function(){var yValue=d3.select(this).attr("value");console.log(yValue);var dataY=function(d){return eval(yValue)};switch(yValue){case"+d.gini":titleY="Gini Index";break;case"+d.press":titleY="Press Freedom";break;case"+d.mfr":titleY="Male to female Ratio";break;case"+d.life_exp":titleY="Life Expectancy";break;case"+d.gre":titleY="Female enrollment ratio";break;case"+d.corruption":titleY="Control of Corruption";break;case"+d.polistab":titleY="Political Stability";break;case"+d.gdphead":titleY="GDP per Capita"}var yScale=d3.scale.linear().domain([d3.max(worldData,function(t){return dataY(t)}),d3.min(worldData,function(t){return dataY(t)})]).range([0,h+xaxisShiftY]).nice();d3.select("#dots-group").selectAll("circle").filter(function(t){return dataY(t)}).transition().duration(1e3).attr({cy:function(t){return yScale(dataY(t))}});var yAxis=d3.svg.axis().scale(yScale).orient("left");yLabel.text(titleY),titleText.text(titleX+" vs. "+titleY),d3.select(".yaxis").transition().duration(1e3).call(yAxis)})});var margin={top:80,right:140,bottom:40,left:60},w=parseInt(d3.select("#scatter-div").style("width"),10),w=w-margin.left-margin.right,h=parseInt(d3.select("#scatter-div").style("height"),10),h=h-margin.top-margin.bottom,canvasPadding={top:10,right:10,bottom:10,left:60},textShift=0,dotsShiftX=0,dotsShiftY=0,xaxisShiftX=60,yaxisShiftX=60,xaxisShiftY=-60,yaxisShiftY=0,infoTop=115,infoLeft=w+margin.left,infoWidth="12em",infoHeight="24em";d3.csv("/8step.io/production_data/world_data/datadev/world.csv",function(error,data){error?console.log(error):console.log(data);var worldData=data,key=function(t,e){return t.country},dataX=function(t){return+t.polistab},dataY=function(t){return 100-+t.press},dataR=function(t){return+t.gdphead};console.log(dataX.toString());var titleX="Political Stabtility",titleY="Press Freedom",titleR="GDP per Capita",titleText=d3.select("h2#chart-title").append("text.title-text").text(titleX+" vs. "+titleY),dotTips=d3.tip().attr("class","d3-tip").style({top:infoTop,left:infoLeft,width:infoWidth,height:infoHeight}).direction("e").html(function(t){return"<p id='tiphead'>"+t.country+"</p><p class='tip-subhead'>Income Group:</p><p class='tip-body'>"+t.ig+"</p><p class='tip-subhead'>Region:</p><p class='tip-body'>"+t.region+"</p>"}),svg=d3.select("#scatter-div").append("svg").attr({width:w+margin.left+margin.right,height:h+margin.top+margin.bottom,id:"canvas"}).append("g").attr({transform:"translate("+margin.left+","+margin.top+")"}),xScale=d3.scale.linear().domain([d3.min(worldData,function(t){return dataX(t)}),d3.max(worldData,function(t){return dataX(t)})]).range([xaxisShiftX,w]).nice(),yScale=d3.scale.linear().domain([d3.max(worldData,function(t){return dataY(t)}),d3.min(worldData,function(t){return dataY(t)})]).range([0,h+xaxisShiftY]).nice(),rScale=d3.scale.linear().domain([0,d3.max(worldData,function(t){return dataR(t)})]).range([4,40]).nice(),xAxis=d3.svg.axis().scale(xScale).orient("bottom"),yAxis=d3.svg.axis().scale(yScale).orient("left"),guideLines=function(t){svg.append("g").classed("guide",!0).append("line").attr("y1",d3.select(".a-dot").attr("cy")).attr("y2",d3.select(".a-dot").attr("cy")).attr("x1",yaxisShiftX).attr("x2",d3.select(".a-dot").attr("cx")).attr("stroke",d3.select(".a-dot").attr("fill")),svg.append("g").classed("guide",!0).append("line").attr("y1",h+xaxisShiftY).attr("y2",d3.select(".a-dot").attr("cy")).attr("x1",d3.select(".a-dot").attr("cx")).attr("x2",d3.select(".a-dot").attr("cx")).attr("stroke",d3.select(".a-dot").attr("fill"))},mouseOn=function(){d3.select(this).attr("opacity",1).classed("a-dot",!0).classed("dots",!1),guideLines(),d3.selectAll("circle.dots").attr("opacity",.15)},mouseOff=function(){d3.select(this).classed("a-dot",!1).classed("dots",!0),d3.selectAll(".guide").remove(),d3.selectAll("circle.dots").attr("opacity",.85)},dotsGroup=svg.append("g").attr({id:"dots-group"}),dotsFilter=dotsGroup.append("defs").append("filter").attr({id:"dots-filter",x:0,y:0,width:"200%",height:"200%"}),shadowOffset=dotsFilter.append("feOffset").attr({result:"offOut",in:"SourceGraphic",dx:20,dy:20}),shadowBlend=dotsFilter.append("feBlend").attr({in:"SourceGraphic",in2:"offOut",mode:"normal"}),dots=d3.select("#dots-group").selectAll("circle").data(worldData,key).enter().append("circle").filter(function(t){return dataX(t)}).filter(function(t){return dataY(t)}).filter(function(t){return dataR(t)}).attr({class:"dots",id:function(t){return t.country},cx:function(t){return xScale(dataX(t))},cy:function(t){return yScale(dataY(t))},r:function(t){return rScale(dataR(t))},"pointer-events":"all",fill:function(t){return"High income: nonOECD"==t.ig?"#FF6E27":"Low income"==t.ig?"#991766":"Upper middle income"==t.ig?"#F34739":"Lower middle income"==t.ig?"#D90F5A":"High income: OECD"==t.ig?"#FFB627":"black"},opacity:.85}).style({}).call(dotTips).on("mouseenter",dotTips.show).on("mouseover",mouseOn).on("mouseleave",dotTips.hide).on("mouseout",mouseOff);svg.append("g").attr({class:"xaxis",transform:"translate(0,"+(h+xaxisShiftY)+")"}).call(xAxis);var xLabel=svg.append("text").attr({class:"x-label","text-anchor":"middle",transform:function(t){return"translate("+w/2+","+h+")"}}).text(titleX);svg.append("g").attr({class:"yaxis",transform:"translate("+yaxisShiftX+",0)"}).call(yAxis);var yLabel=svg.append("text").attr({class:"y-label","text-anchor":"middle",transform:function(t){return"translate(0,"+(h+xaxisShiftY)/2+") rotate(-90)"}}).text(titleY);d3.selectAll(".x-choice").on("click",function(){var xValue=d3.select(this).attr("value");console.log(xValue);var dataX=function(d){return eval(xValue)};switch(xValue){case"+d.gini":titleX="Gini Index";break;case"+d.press":titleX="Press Freedom";break;case"+d.mfr":titleX="Male to female Ratio";break;case"+d.life_exp":titleX="Life Expectancy";break;case"+d.gre":titleX="Female enrollment ratio";break;case"+d.corruption":titleX="Control of Corruption";break;case"+d.polistab":titleX="Political Stability";break;case"+d.gdphead":titleX="GDP per Capita"}var xScale=d3.scale.linear().domain([d3.min(worldData,function(t){return dataX(t)}),d3.max(worldData,function(t){return dataX(t)})]).range([xaxisShiftX,w]).nice();d3.select("#dots-group").selectAll("circle").filter(function(t){return dataX(t)}).transition().duration(1e3).attr({cx:function(t){return xScale(dataX(t))}});var xAxis=d3.svg.axis().scale(xScale).orient("bottom");xLabel.text(titleX),titleText.text(titleX+" vs. "+titleY),d3.select(".xaxis").transition().duration(1e3).call(xAxis)}),d3.selectAll(".y-choice").on("click",function(){var yValue=d3.select(this).attr("value");console.log(yValue);var dataY=function(d){return eval(yValue)};switch(yValue){case"+d.gini":titleY="Gini Index";break;case"+d.press":titleY="Press Freedom";break;case"+d.mfr":titleY="Male to female Ratio";break;case"+d.life_exp":titleY="Life Expectancy";break;case"+d.gre":titleY="Female enrollment ratio";break;case"+d.corruption":titleY="Control of Corruption";break;case"+d.polistab":titleY="Political Stability";break;case"+d.gdphead":titleY="GDP per Capita"}var yScale=d3.scale.linear().domain([d3.max(worldData,function(t){return dataY(t)}),d3.min(worldData,function(t){return dataY(t)})]).range([0,h+xaxisShiftY]).nice();d3.select("#dots-group").selectAll("circle").filter(function(t){return dataY(t)}).transition().duration(1e3).attr({cy:function(t){return yScale(dataY(t))}});var yAxis=d3.svg.axis().scale(yScale).orient("left");yLabel.text(titleY),titleText.text(titleX+" vs. "+titleY),d3.select(".yaxis").transition().duration(1e3).call(yAxis)})});var margin={top:40,right:10,bottom:40,left:10},w=parseInt(d3.select("#barsdiv").style("width"),10),w=w-margin.left-margin.right,h=8e3-margin.top-margin.bottom,canvasPadding={top:0,right:100,bottom:0,left:0},textShiftUp=-134,barShiftUp=-126,axisShiftUp=-18;barpadding=2,labelPaddingLeft=4,labelPaddingTop=barShiftUp+138;var maxDelay=1e4,barDuration=800,axisDuration=800,defaultFade=50,hoverDuration=200,titleText=d3.select("h2#title").append("text.title-text").text("Incidents of Murder, per 100k Individuals, 2013").attr({class:"title-text","font-size":"24px"});d3.csv("/8step.io/production_data/crime_data/datadev/crime.csv",function(t,e){t?console.log(t):console.log(e);var a=e,r=function(t,e){return e},i=function(t){return"M.D."==t.Loc.slice(-4)?t.Loc.substring(0,t.Loc.length-5):"M.S.A."==t.Loc.slice(-6)?t.Loc.substring(0,t.Loc.length-7):t.Loc.substring(0,t.Loc.length-7)},n=d3.tip().attr({class:"d3-tip"}).offset([0,0]).direction("n").html(function(t){return"<p id='tiphead'>"+i(t)+"</p><p id='tipbody'>Population: "+d3.format(",")(+t.Pop)+"</p>"}),l=d3.select("#barsdiv").append("svg").attr({width:w+margin.left+margin.right,height:h+margin.top+margin.bottom,viewBox:"0 0 380 8000",preserveAspectRatio:"xMinYMin meet",id:"canvas"}).append("g").attr({transform:"translate("+margin.left+","+margin.top+")"}).call(n),o=d3.scale.linear().domain([0,d3.max(a,function(t){return+t.murder100k})]).range([0,w-canvasPadding.right]).nice(),s=function(t){return o(+t.murder100k)},d=function(t){return s(t)+labelPaddingLeft},c=d3.scale.ordinal().domain(d3.range(a.length)).rangeRoundBands([0,h],.05),u=d3.svg.axis().scale(o).orient("top").ticks(5);l.selectAll("rect").data(a,r).enter().append("rect").attr({y:function(t,e){return c(e)},x:function(t){return 0},width:s,height:function(t,e){return c.rangeBand()},transform:"translate(0,"+barShiftUp+")",class:"bars"}).on("mouseover",n.show).on("mouseout",n.hide),l.selectAll("text.loclabels").data(a,r).enter().append("text").text(i).attr({x:function(t){return labelPaddingLeft},y:function(t,e){return c(e)+labelPaddingTop},transform:"translate(0,"+textShiftUp+")",class:"loclabels"}),l.selectAll("text.valuelabels").data(a,r).enter().append("text").text(function(t){return d3.format(",")(+t.murder100k)}).attr({x:d,y:function(t,e){return c(e)+labelPaddingTop},transform:"translate(0,"+textShiftUp+")",class:"valuelabels"});l.append("g").attr({class:"xaxis",transform:"translate(0,"+axisShiftUp+")"}).call(u),d3.select("button#violentcrime").on("click",function(){g()}),d3.select("button#rape").on("click",function(){f()}),d3.select("button#murder").on("click",function(){p()});var p=function(){a.sort(function(t,e){return d3.descending(+t.murder100k,+e.murder100k)});var t=d3.scale.linear().domain([0,d3.max(a,function(t){return+t.murder100k})]).range([0,w-canvasPadding.right]).nice();s=function(e){return t(+e.murder100k)},d3.selectAll("rect.bars").data(a,r).transition().delay(function(t,e){return e/a.length*maxDelay}).duration(barDuration).ease("cubic-in-out").attr({width:s,y:function(t,e){return c(e)}}),d3.select("h2#title").transition().duration(barDuration).text("Incidents of Murder, per 100k Individuals, 2013"),d3.selectAll("text.loclabels").data(a,r).transition().duration(barDuration).ease("cubic-in-out").text(i).attr({y:function(t,e){return c(e)+labelPaddingTop}}),d3.selectAll("text.valuelabels").data(a,r).transition().delay(function(t,e){return e/a.length*maxDelay}).duration(barDuration).text(function(t){return d3.format(",")(+t.murder100k)}).attr({x:d,y:function(t,e){return c(e)+labelPaddingTop}});var e=d3.svg.axis().scale(t).orient("top").ticks(5);d3.select(".xaxis").transition().duration(axisDuration).call(e);var n=function(){var i=parseInt(d3.select("#barsdiv").style("width"))-margin.left-margin.right;8e3-margin.top-margin.bototm;t.range([0,i-canvasPadding.right]),d3.select("svg").attr("width",i),l.selectAll("rect.bars").attr("width",s),d3.selectAll("text.valuelabels").data(a,r).attr("x",d),d3.select(".xaxis").call(e)};d3.select(window).on("resize",function(){n()})},f=function(){a.sort(function(t,e){return d3.descending(+t.rape100k,+e.rape100k)});var t=d3.scale.linear().domain([0,d3.max(a,function(t){return+t.rape100k})]).range([0,w-canvasPadding.right]).nice();s=function(e){return t(+e.rape100k)},d3.selectAll("rect.bars").data(a,r).transition().delay(function(t,e){return e/a.length*maxDelay}).duration(barDuration).ease("cubic-in-out").attr({width:s,y:function(t,e){return c(e)}}),d3.select("h2#title").transition().duration(barDuration).text("Incidents of Rape, per 100k Individuals, 2013"),d3.selectAll("text.loclabels").data(a,r).transition().duration(barDuration).ease("cubic-in-out").text(i).attr({y:function(t,e){return c(e)+labelPaddingTop}}),d3.selectAll("text.valuelabels").data(a,r).transition().delay(function(t,e){return e/a.length*maxDelay}).duration(barDuration).text(function(t){return d3.format(",")(+t.rape100k)}).attr({x:d,y:function(t,e){return c(e)+labelPaddingTop}});var e=d3.svg.axis().scale(t).orient("top").ticks(5);d3.select(".xaxis").transition().duration(axisDuration).call(e);var n=function(){var i=parseInt(d3.select("#barsdiv").style("width"))-margin.left-margin.right;8e3-margin.top-margin.bototm;t.range([0,i-canvasPadding.right]),d3.select("svg").attr("width",i),l.selectAll("rect.bars").attr("width",s),d3.selectAll("text.valuelabels").data(a,r).attr("x",d),d3.select(".xaxis").call(e)};d3.select(window).on("resize",function(){n()})},g=function(){a.sort(function(t,e){return d3.descending(+t.violentcrime100k,+e.violentcrime100k)});var t=d3.scale.linear().domain([0,d3.max(a,function(t){return+t.violentcrime100k})]).range([0,w-canvasPadding.right]).nice();s=function(e){return t(+e.violentcrime100k)},d3.selectAll("rect.bars").data(a,r).transition().delay(function(t,e){return e/a.length*maxDelay}).duration(barDuration).ease("cubic-in-out").attr({width:s,y:function(t,e){return c(e)}}),d3.select("h2#title").transition().duration(barDuration).text("Incidents of Violent Crime, per 100k Individuals, 2013"),d3.selectAll("text.loclabels").data(a,r).transition().duration(barDuration).ease("cubic-in-out").text(i).attr({y:function(t,e){return c(e)+labelPaddingTop}}),d3.selectAll("text.valuelabels").data(a,r).transition().delay(function(t,e){return e/a.length*maxDelay}).duration(barDuration).text(function(t){return d3.format(",")(+t.violentcrime100k)}).attr({x:d,y:function(t,e){return c(e)+labelPaddingTop}});var e=d3.svg.axis().scale(t).orient("top").ticks(5);d3.select(".xaxis").transition().duration(axisDuration).call(e);var n=function(){var i=parseInt(d3.select("#barsdiv").style("width"))-margin.left-margin.right;8e3-margin.top-margin.bototm;t.range([0,i-canvasPadding.right]),d3.select("svg").attr("width",i),l.selectAll("rect.bars").attr("width",s),d3.selectAll("text.valuelabels").data(a,r).attr("x",d),d3.select(".xaxis").call(e)};d3.select(window).on("resize",function(){n()})},x=function(){var t=parseInt(d3.select("#barsdiv").style("width"))-margin.left-margin.right;8e3-margin.top-margin.bototm;o.range([0,t-canvasPadding.right]),d3.select("svg").attr("width",t),l.selectAll("rect.bars").attr("width",s),d3.selectAll("text.valuelabels").data(a,r).attr("x",d),d3.select(".xaxis").call(u)};d3.select(window).on("resize",function(){x()})});